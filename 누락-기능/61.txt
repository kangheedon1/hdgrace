<root>

  <!-- [1] í˜„ì¬ ì„¤ì¹˜ëœ í¬ë¡¬ ë²„ì „ í™•ì¸ -->
  <action name="RunProcess">
    <param name="Path">C:\Program Files\Google\Chrome\Application\chrome.exe</param>
    <param name="Args">--version</param>
    <param name="Result">chrome_version_output</param>
  </action>

  <action name="RegexExtract">
    <param name="Text">%chrome_version_output%</param>
    <param name="Pattern">\d+\.\d+\.\d+\.\d+</param>
    <param name="Result">chrome_version</param>
  </action>

  <!-- [2] ì €ì¥ëœ í¬ë¡¬ ë²„ì „ ì½ê¸° -->
  <action name="SetVar" variable="version_file" value="version_tracker.txt" />
  <action name="SetVar" variable="stored_version" value="" />
  <action name="ReadFile" if="FileExists('%version_file%')">
    <param name="Path">%version_file%</param>
    <param name="Variable">stored_version</param>
  </action>

  <!-- [3] ë²„ì „ ë³€ê²½ ì—¬ë¶€ íŒë‹¨ -->
  <action name="If" condition="%chrome_version% != %stored_version%">
    <then>
      <!-- [4] ì—…ë°ì´íŠ¸ ê°ì§€ ë©”ì‹œì§€ -->
      <action name="ShowMessage">
        <param name="Text">ğŸŸ¡ í¬ë¡¬ ë²„ì „ ë³€ê²½ ê°ì§€ë¨: ìë™ í™˜ê²½ ê°±ì‹  ì¤‘...</param>
      </action>

      <!-- [5] UserAgent ì¬ìƒì„± -->
      <action name="RandomUserAgent" variable="ua_new" />
      <action name="WriteFile">
        <param name="Path">useragent.txt</param>
        <param name="Content">%ua_new%</param>
      </action>

      <!-- [6] ì¿ í‚¤ íŒŒì¼ ì‚­ì œ (ëª¨ë“  í”„ë¡œí•„ ì´ˆê¸°í™”) -->
      <action name="GetFiles">
        <param name="Directory">profiles</param>
        <param name="Pattern">cookies.txt</param>
        <param name="OnlyFiles">true</param>
        <param name="Recursive">true</param>
        <param name="Result">cookie_files</param>
      </action>
      <action name="ForEach" variable="cookie_path" in="cookie_files">
        <action name="DeleteFile">
          <param name="Path">%cookie_path%</param>
        </action>
      </action>

      <!-- [7] í¬ë¡¬ ë²„ì „ ê¸°ë¡ ì—…ë°ì´íŠ¸ -->
      <action name="WriteFile">
        <param name="Path">%version_file%</param>
        <param name="Content">%chrome_version%</param>
      </action>

    </then>
  </action>

  <!-- [8] ìµœì‹  UserAgent ë¡œë“œ -->
  <action name="ReadFile">
    <param name="Path">useragent.txt</param>
    <param name="Variable">ua</param>
  </action>
  <action name="SetUserAgent">
    <param name="UserAgent">%ua%</param>
  </action>

  <!-- [9] ì˜ˆì‹œ í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ì´ë™ -->
  <action name="Navigate">
    <param name="URL">https://www.whatismybrowser.com/</param>
  </action>

</root>
