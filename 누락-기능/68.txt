# Create a *copy* of bas_final_full.xml and inject a <resources> block
# tailored for BAS 29.0.0, without touching the original.
from pathlib import Path
import re

src = Path("/mnt/data/bas_outputs/bas_final_full.xml")
dst = Path("/mnt/data/bas_outputs/bas_with_resources.xml")

text = src.read_text(encoding="utf-8", errors="strict")

injection_point = None
m = re.search(r"<language>.*?</language>\s*\n", text)
if m:
    injection_point = m.end()
else:
    # fallback: after first line
    injection_point = 0

resources_block = """\
  <resources>
    <!-- Text / URL inputs -->
    <resource name="CHANNEL_URL" type="String" label="ì±„ë„ URL" required="false" default="" />
    <resource name="VIDEO_URLS" type="List" subtype="String" label="ì˜ìƒ URL ëª©ë¡(ì¤„ë°”ê¿ˆ êµ¬ë¶„)" delimiter="\\n" required="false" />

    <!-- Files -->
    <resource name="PROXY_LIST" type="File" label="í”„ë¡ì‹œ ë¦¬ìŠ¤íŠ¸(.txt, ip:port)" required="false" />
    <resource name="USER_AGENTS" type="File" label="User-Agent ëª©ë¡(.txt)" required="false" />

    <!-- Numbers -->
    <resource name="THREADS" type="Number" label="ë™ì‹œ ìŠ¤ë ˆë“œ ìˆ˜" min="1" max="20" default="1" />
    <resource name="VIEW_DURATION_SEC" type="Number" label="ì‹œì²­ ì‹œê°„(ì´ˆ)" min="10" max="7200" default="300" />
    <resource name="DELAY_MIN_MS" type="Number" label="ì§€ì—° ìµœì†Œ(ms)" min="0" max="60000" default="500" />
    <resource name="DELAY_MAX_MS" type="Number" label="ì§€ì—° ìµœëŒ€(ms)" min="0" max="120000" default="1500" />

    <!-- Booleans mapped to existing variables -->
    <resource name="LIVE_VIEWERS" type="Boolean" label="ğŸŸ¢ LIVE ê³ ì • ì‹œì²­ì ìœ ì§€" default="true" />
    <resource name="SHORTS_OPTIMIZE" type="Boolean" label="ğŸŸ£ Shorts ì‹œì²­ ìµœì í™”" default="true" />
    <resource name="AUTO_ENGAGE" type="Boolean" label="â¤ï¸ ëŒ“ê¸€/ì¢‹ì•„ìš”/êµ¬ë… ìë™í™”" default="true" />
    <resource name="LOOP_VIEW" type="Boolean" label="ğŸ” ì¡°íšŒìˆ˜ ë°˜ë³µ ì…ì¥/ì´íƒˆ" default="true" />

    <!-- Selects / Options -->
    <resource name="BROWSER_PROFILE" type="Select" label="ë¸Œë¼ìš°ì € í”„ë¡œíŒŒì¼" required="false">
      <option value="default">ê¸°ë³¸</option>
      <option value="mobile">ëª¨ë°”ì¼</option>
      <option value="desktop">ë°ìŠ¤í¬íƒ‘</option>
    </resource>
    <resource name="LANGUAGE" type="Select" label="ì–¸ì–´" required="false">
      <option value="ko">í•œêµ­ì–´</option>
      <option value="en">English</option>
      <option value="ja">æ—¥æœ¬èª</option>
    </resource>
  </resources>
"""

# Inject after the <language> tag block
new_text = text[:injection_point] + resources_block + text[injection_point:]

dst.write_text(new_text, encoding="utf-8")

print("ìƒì„± ì™„ë£Œ:", str(dst))
print("ë¦¬ì†ŒìŠ¤ ë¸”ë¡ ë°”ì´íŠ¸ ìˆ˜:", len(resources_block.encode('utf-8')))
# Create a new copy that includes BOTH <resources> and <interface> blocks
# without removing or altering any existing content.
from pathlib import Path
import re

src = Path("/mnt/data/bas_outputs/bas_final_full.xml")
dst = Path("/mnt/data/bas_outputs/bas_with_ui.xml")

text = src.read_text(encoding="utf-8", errors="strict")

# Decide injection point: right after <language>...</language>
lang_match = re.search(r"<language>.*?</language>\s*\n", text)
if lang_match:
    insert_pos = lang_match.end()
else:
    insert_pos = 0  # as earliest safe point

resources_block = """\
  <resources>
    <!-- Text / URL inputs -->
    <resource name="CHANNEL_URL" type="String" label="ì±„ë„ URL" required="false" default="" />
    <resource name="VIDEO_URLS" type="List" subtype="String" label="ì˜ìƒ URL ëª©ë¡(ì¤„ë°”ê¿ˆ êµ¬ë¶„)" delimiter="\\n" required="false" />

    <!-- Files -->
    <resource name="PROXY_LIST" type="File" label="í”„ë¡ì‹œ ë¦¬ìŠ¤íŠ¸(.txt, ip:port)" required="false" />
    <resource name="USER_AGENTS" type="File" label="User-Agent ëª©ë¡(.txt)" required="false" />

    <!-- Numbers -->
    <resource name="THREADS" type="Number" label="ë™ì‹œ ìŠ¤ë ˆë“œ ìˆ˜" min="1" max="20" default="1" />
    <resource name="VIEW_DURATION_SEC" type="Number" label="ì‹œì²­ ì‹œê°„(ì´ˆ)" min="10" max="7200" default="300" />
    <resource name="DELAY_MIN_MS" type="Number" label="ì§€ì—° ìµœì†Œ(ms)" min="0" max="60000" default="500" />
    <resource name="DELAY_MAX_MS" type="Number" label="ì§€ì—° ìµœëŒ€(ms)" min="0" max="120000" default="1500" />

    <!-- Booleans mapped to existing variables -->
    <resource name="LIVE_VIEWERS" type="Boolean" label="ğŸŸ¢ LIVE ê³ ì • ì‹œì²­ì ìœ ì§€" default="true" />
    <resource name="SHORTS_OPTIMIZE" type="Boolean" label="ğŸŸ£ Shorts ì‹œì²­ ìµœì í™”" default="true" />
    <resource name="AUTO_ENGAGE" type="Boolean" label="â¤ï¸ ëŒ“ê¸€/ì¢‹ì•„ìš”/êµ¬ë… ìë™í™”" default="true" />
    <resource name="LOOP_VIEW" type="Boolean" label="ğŸ” ì¡°íšŒìˆ˜ ë°˜ë³µ ì…ì¥/ì´íƒˆ" default="true" />

    <!-- Selects / Options -->
    <resource name="BROWSER_PROFILE" type="Select" label="ë¸Œë¼ìš°ì € í”„ë¡œíŒŒì¼" required="false">
      <option value="default">ê¸°ë³¸</option>
      <option value="mobile">ëª¨ë°”ì¼</option>
      <option value="desktop">ë°ìŠ¤í¬íƒ‘</option>
    </resource>
    <resource name="LANGUAGE" type="Select" label="ì–¸ì–´" required="false">
      <option value="ko">í•œêµ­ì–´</option>
      <option value="en">English</option>
      <option value="ja">æ—¥æœ¬èª</option>
    </resource>
  </resources>
"""

interface_block = """\
  <interface>
    <group label="ë©”ì¸ ì œì–´">
      <button label="ğŸŸ¢ LIVE ê³ ì • ì‹œì²­ì ìœ ì§€" variable="LIVE_VIEWERS" default="true" />
      <button label="ğŸŸ£ Shorts ì‹œì²­ ìµœì í™”" variable="SHORTS_OPTIMIZE" default="true" />
      <button label="â¤ï¸ ëŒ“ê¸€/ì¢‹ì•„ìš”/êµ¬ë… ìë™í™”" variable="AUTO_ENGAGE" default="true" />
      <button label="ğŸ” ì¡°íšŒìˆ˜ ë°˜ë³µ ì…ì¥/ì´íƒˆ" variable="LOOP_VIEW" default="true" />
    </group>
    <group label="ì‹¤í–‰ ì„¤ì •">
      <text label="ì±„ë„ URL" variable="CHANNEL_URL" />
      <textarea label="ì˜ìƒ URL ëª©ë¡(ì¤„ë°”ê¿ˆ)" variable="VIDEO_URLS" />
      <file label="í”„ë¡ì‹œ ë¦¬ìŠ¤íŠ¸(.txt)" variable="PROXY_LIST" />
      <file label="User-Agent ëª©ë¡(.txt)" variable="USER_AGENTS" />
      <number label="ë™ì‹œ ìŠ¤ë ˆë“œ ìˆ˜" variable="THREADS" />
      <number label="ì‹œì²­ ì‹œê°„(ì´ˆ)" variable="VIEW_DURATION_SEC" />
      <number label="ì§€ì—° ìµœì†Œ(ms)" variable="DELAY_MIN_MS" />
      <number label="ì§€ì—° ìµœëŒ€(ms)" variable="DELAY_MAX_MS" />
      <select label="ë¸Œë¼ìš°ì € í”„ë¡œíŒŒì¼" variable="BROWSER_PROFILE" />
      <select label="ì–¸ì–´" variable="LANGUAGE" />
    </group>
  </interface>
"""

insertion = resources_block + "\n" + interface_block + "\n"
new_text = text[:insert_pos] + insertion + text[insert_pos:]
dst.write_text(new_text, encoding="utf-8")

print("ìƒì„± ì™„ë£Œ:", str(dst))
print("ì¶”ê°€ëœ ë¸”ë¡ ì´ ë°”ì´íŠ¸:", len(insertion.encode("utf-8")))
