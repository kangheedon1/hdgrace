
<macro name="SystemToggleUI">
  <action name="CreatePopup"><Title>ê¸°ëŠ¥ ì„ íƒ</Title><Message>ì‚¬ìš©í•  ê³ ê¸‰ ê¸°ëŠ¥ì„ ì„ íƒí•˜ì„¸ìš”:</Message></action>
  <action name="AddChoice"><Option>ğŸ•’ ì˜ˆì•½ ì‹¤í–‰ (06~18ì‹œ)</Option></action>
  <action name="AddChoice"><Option>ğŸ“ˆ ì‹œì²­ ìœ ì§€ìœ¨ ê°œë³„ ì¡°ì •</Option></action>
  <action name="AddChoice"><Option>ğŸŒ ì „ë¬¸ í”„ë¡ì‹œ API ì‚¬ìš©</Option></action>
  <action name="AddChoice"><Option>ğŸ§¬ ë¸Œë¼ìš°ì € í”„ë¡œíŒŒì¼ë§ ì ìš©</Option></action>
  <action name="AddChoice"><Option>ğŸ“Œ ë‹¤ìŒ ì˜ìƒ í´ë¦­ ì‹œë®¬ë ˆì´ì…˜</Option></action>
  <action name="ShowPopup"/>
  <action name="GetUserChoice"><Variable>SelectedFeatures</Variable></action>
  <action name="LogEvent"><Type>UI</Type><Details>ì„ íƒëœ ê¸°ëŠ¥: {SelectedFeatures}</Details></action>
</macro>
<macro name="ApplyBrowserFingerprinting">
  <action name="CallURL">
    <URL>https://fp.bablosoft.com/api/fingerprint?token=J6tgC3yKrA67k6wr4SpeqWxLlRqgyZ8N0AhkmCmV9jAPC5hxuo1jt9TfFDsWWhJI</URL>
    <Method>GET</Method>
    <Variable>BrowserFingerprint</Variable>
  </action>
  <action name="SetFingerprintProfile"><Data>{BrowserFingerprint}</Data></action>

  <action name="CallURL">
    <URL>https://proxygeo.com/BrowserFingerprints?api_key=ff893e3d-5f3e-43d9-8ac4-b12890fcb72f</URL>
    <Method>GET</Method>
    <Variable>GeoProfile</Variable>
  </action>
  <action name="MergeFingerprint"><Base>{BrowserFingerprint}</Base><Geo>{GeoProfile}</Geo><Variable>FinalFingerprint</Variable></action>

  <action name="ApplyFingerprint"><Profile>{FinalFingerprint}</Profile></action>
  <action name="LogEvent"><Type>Fingerprint</Type><Details>ë¸Œë¼ìš°ì € í”„ë¡œíŒŒì¼ ì ìš© ì™„ë£Œ</Details></action>
</macro>
<macro name="CheckExecutionTime">
  <action name="GetCurrentHour"><Variable>CurrentHour</Variable></action>
  <if condition="{CurrentHour} &gt;= 6 && {CurrentHour} &lt;= 18">
    <then><action name="SetVariable"><Variable>CanRun</Variable><Value>true</Value></action></then>
    <else><action name="Exit"><Reason>ì˜ˆì•½ ì‹œê°„ ì™¸ ì‹¤í–‰ ê¸ˆì§€</Reason></action></else>
  </if>
</macro>
<macro name="GetWatchTimeRatioUI">
  <action name="CreatePopup"><Title>ì‹œì²­ ìœ ì§€ìœ¨</Title><Message>ì˜ìƒ ìœ ì§€ìœ¨ ë²”ìœ„ë¥¼ ì„¤ì •í•˜ì„¸ìš” (%):</Message></action>
  <action name="AddInput"><Label>ìµœì†Œ ìœ ì§€ìœ¨</Label><DefaultValue>60</DefaultValue><Variable>MinRate</Variable></action>
  <action name="AddInput"><Label>ìµœëŒ€ ìœ ì§€ìœ¨</Label><DefaultValue>100</DefaultValue><Variable>MaxRate</Variable></action>
  <action name="ShowPopup"/>
  <action name="CalculateDuration"><VideoLength>{VideoTotalLength}</VideoLength><Min>{MinRate}</Min><Max>{MaxRate}</Max><Variable>WatchDuration</Variable></action>
</macro>
<macro name="ClickNextVideo">
  <action name="Wait"><Time>5</Time></action>
  <action name="ScrollPage"/>
  <action name="RandomClick"><Selector>.next-video-thumbnail</Selector></action>
  <action name="LogEvent"><Type>Behavior</Type><Details>ë‹¤ìŒ ì˜ìƒ í´ë¦­ ì‹œë®¬ë ˆì´ì…˜</Details></action>
</macro>
<macro name="SelectProxySourceUI">
  <action name="CreatePopup"><Title>í”„ë¡ì‹œ ê³µê¸‰ì ì„ íƒ</Title><Message>ì‚¬ìš©í•  í”„ë¡ì‹œ ì œê³µ ì—…ì²´ë¥¼ ì„ íƒí•˜ì„¸ìš”:</Message></action>
  <action name="AddChoice"><Option>ì§ì ‘ì…ë ¥</Option></action>
  <action name="AddChoice"><Option>BrightData</Option></action>
  <action name="AddChoice"><Option>SmartProxy</Option></action>
  <action name="ShowPopup"/>
  <action name="GetUserChoice"><Variable>SelectedProxySource</Variable></action>

  <if condition="{SelectedProxySource} == 'BrightData'">
    <then>
      <action name="SetVariable"><Variable>ProxyAPI</Variable><Value>https://api.brightdata.com/proxies?key=API_KEY</Value></action>
    </then>
  </if>

  <if condition="{SelectedProxySource} == 'SmartProxy'">
    <then>
      <action name="SetVariable"><Variable>ProxyAPI</Variable><Value>https://proxy.smartproxy.com/v1/list?token=SMART_TOKEN</Value></action>
    </then>
  </if>

  <action name="LogEvent"><Type>ProxySource</Type><Details>ì„ íƒëœ ì†ŒìŠ¤: {SelectedProxySource}</Details></action>
</macro>
<macro name="EnableProfileAndNextClickUI">
  <action name="CreatePopup"><Title>ë¸Œë¼ìš°ì € ì˜µì…˜</Title><Message>í”„ë¡œíŒŒì¼ë§ê³¼ ì‚¬ìš©ì í–‰ë™ ì‹œë®¬ë ˆì´ì…˜ ì„¤ì •</Message></action>
  <action name="AddCheckbox"><Option>ë¸Œë¼ìš°ì € í”„ë¡œíŒŒì¼ë§ í™œì„±í™”</Option><Variable>EnableProfile</Variable></action>
  <action name="AddCheckbox"><Option>ë‹¤ìŒ ì˜ìƒ í´ë¦­ ì‹œë®¬ë ˆì´ì…˜</Option><Variable>EnableNextClick</Variable></action>
  <action name="ShowPopup"/>
</macro>

<macro name="ApplyProfileSimulation">
  <if condition="{EnableProfile} == true">
    <then>
      <action name="ApplyFingerprintAPI">
        <URL>https://fp.bablosoft.com/?key=J6tgC3yKrA67k6wr4SpeqWxLlRqgyZ8N0AhkmCmV9jAPC5hxuo1jt9TfFDsWWhJI</URL>
      </action>
    </then>
  </if>

  <if condition="{EnableNextClick} == true">
    <then>
      <action name="Wait"><Seconds>5</Seconds></action>
      <action name="Click"><Selector>.next-button, .ytp-next-button</Selector></action>
      <action name="WatchLiveStream"><URL>ìë™í´ë¦­ëœURL</URL><Duration>{Random(600, 1200)}</Duration></action>
    </then>
  </if>
</macro>
<macro name="FilterFastProxies">
  <parameter name="InputList"/>
  <action name="SetVariable"><Variable>FastProxies</Variable><Value>[]</Value></action>

  <loop name="CheckLoop" from="0" to="{InputList.length - 1}">
    <action name="MeasureProxySpeed">
      <Proxy>{InputList[{CheckLoop}]}</Proxy>
      <Timeout>1500</Timeout>
      <Variable>PingResult</Variable>
    </action>
    <if condition="{PingResult} < 1000">
      <then>
        <action name="AddToList"><List>{FastProxies}</List><Item>{InputList[{CheckLoop}]}</Item></action>
      </then>
    </if>
  </loop>

  <action name="LogEvent"><Type>SpeedFilter</Type><Details>ë¹ ë¥¸ í”„ë¡ì‹œ ìˆ˜: {FastProxies.length}</Details></action>
</macro>
<macro name="CIDRFilter">
  <parameter name="ProxyList"/>
  <parameter name="AllowedCIDRs"/>
  <action name="SetVariable"><Variable>FilteredProxies</Variable><Value>[]</Value></action>

  <loop name="CIDRLoop" from="0" to="{ProxyList.length - 1}">
    <action name="GetIP"><Proxy>{ProxyList[{CIDRLoop}]}</Proxy><Variable>ProxyIP</Variable></action>
    <action name="CheckIPInCIDR"><IP>{ProxyIP}</IP><CIDRs>{AllowedCIDRs}</CIDRs><Result>IsAllowed</Result></action>
    <if condition="{IsAllowed} == true">
      <then>
        <action name="AddToList"><List>{FilteredProxies}</List><Item>{ProxyList[{CIDRLoop}]}</Item></action>
      </then>
    </if>
  </loop>

  <action name="LogEvent"><Type>CIDRFilter</Type><Details>CIDR í†µê³¼ í”„ë¡ì‹œ ìˆ˜: {FilteredProxies.length}</Details></action>
</macro>
<macro name="SelectViewStrategyUI">
  <action name="CreatePopup"><Title>ì‹œì²­ ì „ëµ ì„ íƒ</Title><Message>URL ì‹œì²­ ì „ëµì„ ì„ íƒí•˜ì„¸ìš”:</Message></action>
  <action name="AddChoice"><Option>ì§‘ì¤‘ ì‹œì²­ (1ê°œ URL)</Option></action>
  <action name="AddChoice"><Option>ë¶„ì‚° ì‹œì²­ (ì—¬ëŸ¬ URL)</Option></action>
  <action name="ShowPopup"/>
  <action name="GetUserChoice"><Variable>ViewStrategy</Variable></action>
</macro>
<macro name="Main">
  <action name="CallMacro"><Name>SelectCountryUI</Name></action>
  <action name="ReadFile"><File>./proxies/global_proxies.txt</File><Variable>ProxyList</Variable></action>
  <action name="ReadFile"><File>./data/target_urls.txt</File><Variable>TargetURLs</Variable></action>
  <action name="CallMacro"><Name>FilterFastProxies</Name><Parameters><InputList>{ProxyList}</InputList></Parameters></action>
  <action name="CallMacro"><Name>CIDRFilter</Name><Parameters><ProxyList>{FastProxies}</ProxyList><AllowedCIDRs>1.1.1.0/24,2.2.2.0/24</AllowedCIDRs></Parameters></action>
  <action name="CallMacro"><Name>SelectViewStrategyUI</Name></action>
  <action name="SetVariable"><Variable>FinalProxyList</Variable><Value>{FilteredProxies}</Value></action>
  <action name="CallMacro"><Name>FixedViewerSystem_ElitePlus</Name></action>
</macro><?xml version="1.0" encoding="UTF-8"?>
<project>
  <settings>
    <MaxThreads>500</MaxThreads>
    <ParallelExecution>true</ParallelExecution>
    <ThreadDelay>50</ThreadDelay>
    <ProxyRotationInterval>300</ProxyRotationInterval>
    <ViewerHealthCheckInterval>60</ViewerHealthCheckInterval>
  </settings>

  <macro name="SelectProxyFormatUI">
    <action name="CreatePopup"><Title>í”„ë¡ì‹œ í˜•ì‹ ì„ íƒ</Title><Message>ë‹¤ìŒ ì¤‘ í”„ë¡ì‹œ í˜•ì‹ì„ ì„ íƒí•˜ì„¸ìš”:
1. host:port:username:password
2. username:password:host:port
3. host:port
(IPv4, IPv6, SOCKS4/5 ëª¨ë‘ ì§€ì›)</Message></action>
    <action name="AddChoice"><Option>host:port:username:password</Option></action>
    <action name="AddChoice"><Option>username:password:host:port</Option></action>
    <action name="AddChoice"><Option>host:port</Option></action>
    <action name="ShowPopup"/>
    <action name="GetUserChoice"><Variable>SelectedFormat</Variable></action>
    <action name="SetProxyFormat"><Format>{SelectedFormat}</Format></action>
    <action name="LogEvent"><Type>ProxyFormat</Type><Details>í”„ë¡ì‹œ í˜•ì‹: {SelectedFormat}</Details></action>
  </macro>

  <macro name="KoreaISPChange">
    <parameter name="Account"/>
    <action name="SelectRandomISP"><ISPList>KT,SKT,LGU+</ISPList><Variable>SelectedISP</Variable></action>
    <action name="ChangeProxy"><ISP>{SelectedISP}</ISP><Proxy>{Account.proxy}</Proxy></action>
    <action name="LogEvent"><Type>ISPChange</Type><Details>í•œêµ­ ISP ë³€ê²½ ì™„ë£Œ: {SelectedISP}</Details></action>
  </macro>

  <macro name="ValidateAndRotateProxy">
    <parameter name="Account"/>
    <action name="DetectProxyFormat"><Input>{Account.proxy}</Input><Variable>ProxyFormat</Variable></action>
    <action name="CheckProxyConnectivity"><Proxy>{Account.proxy}</Proxy><Result>Connected</Result></action>
    <if condition="{Connected} == false">
      <then>
        <action name="LogEvent"><Type>Error</Type><Details>í”„ë¡ì‹œ ì—°ê²° ì‹¤íŒ¨: {Account.proxy}</Details></action>
        <action name="RotateToBackupProxy"/>
      </then>
    </if>
  </macro>

  <macro name="AutoSelectFastProxy">
    <parameter name="ProxyList"/>
    <action name="SetVariable"><Variable>BestProxy</Variable><Value></Value></action>
    <action name="SetVariable"><Variable>BestSpeed</Variable><Value>9999</Value></action>

    <loop name="SpeedCheckLoop" from="0" to="{ProxyList.length - 1}">
      <action name="MeasureProxySpeed"><Proxy>{ProxyList[{SpeedCheckLoop}]}</Proxy><Variable>Speed</Variable></action>
      <if condition="{Speed} < {BestSpeed}">
        <then>
          <action name="SetVariable"><Variable>BestSpeed</Variable><Value>{Speed}</Value></action>
          <action name="SetVariable"><Variable>BestProxy</Variable><Value>{ProxyList[{SpeedCheckLoop}]}</Value></action>
        </then>
      </if>
    </loop>
    <action name="SetProxy"><Proxy>{BestProxy}</Proxy></action>
    <action name="LogEvent"><Type>FastProxy</Type><Details>ê°€ì¥ ë¹ ë¥¸ í”„ë¡ì‹œ: {BestProxy} ({BestSpeed}ms)</Details></action>
  </macro>

  <macro name="SetupAdvancedProxyUI">
    <action name="CreateUI"/>
    <action name="SetUIColorScheme"><Scheme>Dark</Scheme></action>
    <action name="AddButton" label="í”„ë¡ì‹œ í˜•ì‹ ì„ íƒ" action="CallMacro"><Name>SelectProxyFormatUI</Name></action>
    <action name="AddButton" label="í•œêµ­ ISP ìë™ ë³€ê²½" action="CallMacro"><Name>KoreaISPChange</Name></action>
    <action name="AddButton" label="ì†ë„ ë¹ ë¥¸ í”„ë¡ì‹œ ìë™ì„ íƒ" action="CallMacro"><Name>AutoSelectFastProxy</Name></action>
    <action name="StartStopControl"/>
  </macro>

  <macro name="MainExecution">
    <action name="CallMacro"><Name>SetupAdvancedProxyUI</Name></action>
    <action name="ReadFile"><File>./proxies/proxy_list.txt</File><Variable>ProxyList</Variable></action>

    <loop name="MainLoop" from="0" to="{ProxyList.length - 1}" parallel="true" max_threads="500">
      <action name="SetVariable"><Variable>CurrentProxy</Variable><Value>{ProxyList[{MainLoop}]}</Value></action>
      <action name="SetVariable"><Variable>Account</Variable><Value><proxy>{CurrentProxy}</proxy></Value></action>
      <action name="CallMacro"><Name>ValidateAndRotateProxy</Name><Parameters><Account>{Account}</Account></Parameters></action>
      <action name="CallMacro"><Name>KoreaISPChange</Name><Parameters><Account>{Account}</Account></Parameters></action>
    </loop>
  </macro>

  <macro name="Main">
    <action name="CallMacro"><Name>MainExecution</Name></action>
  </macro>
</project>
<?xml version="1.0" encoding="UTF-8"?>
<project>
  <settings>
    <MaxThreads>500</MaxThreads>
    <ParallelExecution>true</ParallelExecution>
    <ThreadDelay>50</ThreadDelay>
  </settings>

  <!-- ğŸŒ CIDR í•„í„°ë§ -->
  <macro name="FilterByCIDR">
    <parameter name="ProxyList"/>
    <parameter name="CIDRRange"/>
    <action name="SetVariable"><Variable>FilteredList</Variable><Value>[]</Value></action>
    <loop name="CIDRLoop" from="0" to="{ProxyList.length - 1}">
      <action name="ExtractIP"><Proxy>{ProxyList[{CIDRLoop}]}</Proxy><Variable>ProxyIP</Variable></action>
      <action name="CheckCIDR"><IP>{ProxyIP}</IP><CIDR>{CIDRRange}</CIDR><Result>IsInside</Result></action>
      <if condition="{IsInside} == true">
        <then>
          <action name="AppendToList"><List>{FilteredList}</List><Item>{ProxyList[{CIDRLoop}]}</Item></action>
        </then>
      </if>
    </loop>
    <action name="SetVariable"><Variable>ProxyList</Variable><Value>{FilteredList}</Value></action>
  </macro>

  <!-- ğŸ—ƒï¸ DB ì €ì¥ (MongoDB + SQLite ì§€ì›) -->
  <macro name="SaveToDatabase">
    <parameter name="Data"/>
    <parameter name="DBType"/>
    <if condition="{DBType} == 'MongoDB'">
      <then>
        <action name="MongoInsert">
          <Connection>mongodb://localhost:27017</Connection>
          <Database>bas_data</Database>
          <Collection>proxy_logs</Collection>
          <Document>{Data}</Document>
        </action>
      </then>
    </if>
    <if condition="{DBType} == 'SQLite'">
      <then>
        <action name="SQLiteInsert">
          <File>./data/log.db</File>
          <Table>logs</Table>
          <Data>{Data}</Data>
        </action>
      </then>
    </if>
  </macro>

  <!-- ğŸ‘¥ GoLogin/Multilogin ì—°ê²° -->
  <macro name="UseBrowserProfile">
    <parameter name="Service"/>
    <parameter name="ProfileID"/>
    <if condition="{Service} == 'GoLogin'">
      <then>
        <action name="OpenGoLoginProfile"><Token>YOUR_GoLogin_TOKEN</Token><ProfileID>{ProfileID}</ProfileID></action>
      </then>
    </if>
    <if condition="{Service} == 'Multilogin'">
      <then>
        <action name="OpenMultiloginProfile"><Token>YOUR_Multilogin_TOKEN</Token><ProfileID>{ProfileID}</ProfileID></action>
      </then>
    </if>
  </macro>

  <!-- ğŸ–¥ï¸ UI: í† ê¸€ íŒ¨ë„ -->
  <macro name="SetupUIPanel">
    <action name="CreateUI"/>
    <action name="AddButton" label="CIDR í•„í„°ë§ ì‹¤í–‰" action="CallMacro"><Name>FilterByCIDR</Name></action>
    <action name="AddButton" label="í”„ë¡ì‹œ DB ì €ì¥" action="CallMacro"><Name>SaveToDatabase</Name></action>
    <action name="AddButton" label="GoLogin ì‹¤í–‰" action="CallMacro"><Name>UseBrowserProfile</Name></action>
    <action name="StartStopControl"/>
  </macro>

  <!-- ğŸ” ì „ì²´ ì‹¤í–‰ ë£¨í”„ -->
  <macro name="MainExecution">
    <action name="CallMacro"><Name>SetupUIPanel</Name></action>
    <action name="ReadFile"><File>./proxies/proxy_list.txt</File><Variable>ProxyList</Variable></action>

    <loop name="MainLoop" from="0" to="{ProxyList.length - 1}" parallel="true" max_threads="500">
      <action name="SetVariable"><Variable>CurrentProxy</Variable><Value>{ProxyList[{MainLoop}]}</Value></action>

      <!-- í”„ë¡ì‹œ ì†ë„ ì¸¡ì • -->
      <action name="MeasureProxySpeed"><Proxy>{CurrentProxy}</Proxy><Variable>Speed</Variable></action>

      <!-- DB ì €ì¥ -->
      <action name="SetVariable"><Variable>LogData</Variable>
        <Value>{"proxy":"{CurrentProxy}","speed":"{Speed}","timestamp":"{Time.Now}"}</Value>
      </action>
      <action name="CallMacro"><Name>SaveToDatabase</Name>
        <Parameters>
          <Data>{LogData}</Data>
          <DBType>MongoDB</DBType>
        </Parameters>
      </action>
    </loop>
  </macro>

  <macro name="Main">
    <action name="CallMacro"><Name>MainExecution</Name></action>
  </macro>
</project>

<?xml version="1.0" encoding="UTF-8"?>
<project>
  <settings>
    <MaxThreads>500</MaxThreads>
    <ParallelExecution>true</ParallelExecution>
    <ThreadDelay>50</ThreadDelay>
    <ProxyRotationInterval>300</ProxyRotationInterval>
    <ViewerHealthCheckInterval>60</ViewerHealthCheckInterval>
  </settings>

  <macro name="SelectProxyFormatUI">
    <action name="CreatePopup"><Title>í”„ë¡ì‹œ í˜•ì‹ ì„ íƒ</Title><Message>ë‹¤ìŒ ì¤‘ í”„ë¡ì‹œ í˜•ì‹ì„ ì„ íƒí•˜ì„¸ìš”:
1. host:port:username:password
2. username:password:host:port
3. host:port
(IPv4, IPv6, SOCKS4/5 ëª¨ë‘ ì§€ì›)</Message></action>
    <action name="AddChoice"><Option>host:port:username:password</Option></action>
    <action name="AddChoice"><Option>username:password:host:port</Option></action>
    <action name="AddChoice"><Option>host:port</Option></action>
    <action name="ShowPopup"/>
    <action name="GetUserChoice"><Variable>SelectedFormat</Variable></action>
    <action name="SetProxyFormat"><Format>{SelectedFormat}</Format></action>
    <action name="LogEvent"><Type>ProxyFormat</Type><Details>í”„ë¡ì‹œ í˜•ì‹: {SelectedFormat}</Details></action>
  </macro>

  <macro name="KoreaISPChange">
    <parameter name="Account"/>
    <action name="SelectRandomISP"><ISPList>KT,SKT,LGU+</ISPList><Variable>SelectedISP</Variable></action>
    <action name="ChangeProxy"><ISP>{SelectedISP}</ISP><Proxy>{Account.proxy}</Proxy></action>
    <action name="LogEvent"><Type>ISPChange</Type><Details>í•œêµ­ ISP ë³€ê²½ ì™„ë£Œ: {SelectedISP}</Details></action>
  </macro>

  <macro name="ValidateAndRotateProxy">
    <parameter name="Account"/>
    <action name="DetectProxyFormat"><Input>{Account.proxy}</Input><Variable>ProxyFormat</Variable></action>
    <action name="CheckProxyConnectivity"><Proxy>{Account.proxy}</Proxy><Result>Connected</Result></action>
    <if condition="{Connected} == false">
      <then>
        <action name="LogEvent"><Type>Error</Type><Details>í”„ë¡ì‹œ ì—°ê²° ì‹¤íŒ¨: {Account.proxy}</Details></action>
        <action name="RotateToBackupProxy"/>
      </then>
    </if>
  </macro>

  <macro name="AutoSelectFastProxy">
    <parameter name="ProxyList"/>
    <action name="SetVariable"><Variable>BestProxy</Variable><Value></Value></action>
    <action name="SetVariable"><Variable>BestSpeed</Variable><Value>9999</Value></action>

    <loop name="SpeedCheckLoop" from="0" to="{ProxyList.length - 1}">
      <action name="MeasureProxySpeed"><Proxy>{ProxyList[{SpeedCheckLoop}]}</Proxy><Variable>Speed</Variable></action>
      <if condition="{Speed} < {BestSpeed}">
        <then>
          <action name="SetVariable"><Variable>BestSpeed</Variable><Value>{Speed}</Value></action>
          <action name="SetVariable"><Variable>BestProxy</Variable><Value>{ProxyList[{SpeedCheckLoop}]}</Value></action>
        </then>
      </if>
    </loop>
    <action name="SetProxy"><Proxy>{BestProxy}</Proxy></action>
    <action name="LogEvent"><Type>FastProxy</Type><Details>ê°€ì¥ ë¹ ë¥¸ í”„ë¡ì‹œ: {BestProxy} ({BestSpeed}ms)</Details></action>
  </macro>

  <macro name="SetupAdvancedProxyUI">
    <action name="CreateUI"/>
    <action name="SetUIColorScheme"><Scheme>Dark</Scheme></action>
    <action name="AddButton" label="í”„ë¡ì‹œ í˜•ì‹ ì„ íƒ" action="CallMacro"><Name>SelectProxyFormatUI</Name></action>
    <action name="AddButton" label="í•œêµ­ ISP ìë™ ë³€ê²½" action="CallMacro"><Name>KoreaISPChange</Name></action>
    <action name="AddButton" label="ì†ë„ ë¹ ë¥¸ í”„ë¡ì‹œ ìë™ì„ íƒ" action="CallMacro"><Name>AutoSelectFastProxy</Name></action>
    <action name="StartStopControl"/>
  </macro>

  <macro name="MainExecution">
    <action name="CallMacro"><Name>SetupAdvancedProxyUI</Name></action>
    <action name="ReadFile"><File>./proxies/proxy_list.txt</File><Variable>ProxyList</Variable></action>

    <loop name="MainLoop" from="0" to="{ProxyList.length - 1}" parallel="true" max_threads="500">
      <action name="SetVariable"><Variable>CurrentProxy</Variable><Value>{ProxyList[{MainLoop}]}</Value></action>
      <action name="SetVariable"><Variable>Account</Variable><Value><proxy>{CurrentProxy}</proxy></Value></action>
      <action name="CallMacro"><Name>ValidateAndRotateProxy</Name><Parameters><Account>{Account}</Account></Parameters></action>
      <action name="CallMacro"><Name>KoreaISPChange</Name><Parameters><Account>{Account}</Account></Parameters></action>
    </loop>
  </macro>

  <macro name="Main">
    <action name="CallMacro"><Name>MainExecution</Name></action>
  </macro>
</project>
<?xml version="1.0" encoding="UTF-8"?>
<project>
  <settings>
    <MaxThreads>500</MaxThreads>
    <ParallelExecution>true</ParallelExecution>
    <ThreadDelay>50</ThreadDelay>
  </settings>

  <!-- ğŸŒ CIDR í•„í„°ë§ -->
  <macro name="FilterByCIDR">
    <parameter name="ProxyList"/>
    <parameter name="CIDRRange"/>
    <action name="SetVariable"><Variable>FilteredList</Variable><Value>[]</Value></action>
    <loop name="CIDRLoop" from="0" to="{ProxyList.length - 1}">
      <action name="ExtractIP"><Proxy>{ProxyList[{CIDRLoop}]}</Proxy><Variable>ProxyIP</Variable></action>
      <action name="CheckCIDR"><IP>{ProxyIP}</IP><CIDR>{CIDRRange}</CIDR><Result>IsInside</Result></action>
      <if condition="{IsInside} == true">
        <then>
          <action name="AppendToList"><List>{FilteredList}</List><Item>{ProxyList[{CIDRLoop}]}</Item></action>
        </then>
      </if>
    </loop>
    <action name="SetVariable"><Variable>ProxyList</Variable><Value>{FilteredList}</Value></action>
  </macro>

  <!-- ğŸ—ƒï¸ DB ì €ì¥ (MongoDB + SQLite ì§€ì›) -->
  <macro name="SaveToDatabase">
    <parameter name="Data"/>
    <parameter name="DBType"/>
    <if condition="{DBType} == 'MongoDB'">
      <then>
        <action name="MongoInsert">
          <Connection>mongodb://localhost:27017</Connection>
          <Database>bas_data</Database>
          <Collection>proxy_logs</Collection>
          <Document>{Data}</Document>
        </action>
      </then>
    </if>
    <if condition="{DBType} == 'SQLite'">
      <then>
        <action name="SQLiteInsert">
          <File>./data/log.db</File>
          <Table>logs</Table>
          <Data>{Data}</Data>
        </action>
      </then>
    </if>
  </macro>

  <!-- ğŸ‘¥ GoLogin/Multilogin ì—°ê²° -->
  <macro name="UseBrowserProfile">
    <parameter name="Service"/>
    <parameter name="ProfileID"/>
    <if condition="{Service} == 'GoLogin'">
      <then>
        <action name="OpenGoLoginProfile"><Token>YOUR_GoLogin_TOKEN</Token><ProfileID>{ProfileID}</ProfileID></action>
      </then>
    </if>
    <if condition="{Service} == 'Multilogin'">
      <then>
        <action name="OpenMultiloginProfile"><Token>YOUR_Multilogin_TOKEN</Token><ProfileID>{ProfileID}</ProfileID></action>
      </then>
    </if>
  </macro>

  <!-- ğŸ–¥ï¸ UI: í† ê¸€ íŒ¨ë„ -->
  <macro name="SetupUIPanel">
    <action name="CreateUI"/>
    <action name="AddButton" label="CIDR í•„í„°ë§ ì‹¤í–‰" action="CallMacro"><Name>FilterByCIDR</Name></action>
    <action name="AddButton" label="í”„ë¡ì‹œ DB ì €ì¥" action="CallMacro"><Name>SaveToDatabase</Name></action>
    <action name="AddButton" label="GoLogin ì‹¤í–‰" action="CallMacro"><Name>UseBrowserProfile</Name></action>
    <action name="StartStopControl"/>
  </macro>

  <!-- ğŸ” ì „ì²´ ì‹¤í–‰ ë£¨í”„ -->
  <macro name="MainExecution">
    <action name="CallMacro"><Name>SetupUIPanel</Name></action>
    <action name="ReadFile"><File>./proxies/proxy_list.txt</File><Variable>ProxyList</Variable></action>

    <loop name="MainLoop" from="0" to="{ProxyList.length - 1}" parallel="true" max_threads="500">
      <action name="SetVariable"><Variable>CurrentProxy</Variable><Value>{ProxyList[{MainLoop}]}</Value></action>

      <!-- í”„ë¡ì‹œ ì†ë„ ì¸¡ì • -->
      <action name="MeasureProxySpeed"><Proxy>{CurrentProxy}</Proxy><Variable>Speed</Variable></action>

      <!-- DB ì €ì¥ -->
      <action name="SetVariable"><Variable>LogData</Variable>
        <Value>{"proxy":"{CurrentProxy}","speed":"{Speed}","timestamp":"{Time.Now}"}</Value>
      </action>
      <action name="CallMacro"><Name>SaveToDatabase</Name>
        <Parameters>
          <Data>{LogData}</Data>
          <DBType>MongoDB</DBType>
        </Parameters>
      </action>
    </loop>
  </macro>

  <macro name="Main">
    <action name="CallMacro"><Name>MainExecution</Name></action>
  </macro>
</project>
<?xml version="1.0" encoding="UTF-8"?>
<project>
  <settings>
    <MaxThreads>500</MaxThreads>
    <ParallelExecution>true</ParallelExecution>
    <ThreadDelay>50</ThreadDelay>
    <ViewerHealthCheckInterval>60</ViewerHealthCheckInterval>
  </settings>

  <!-- UI: DB ì„ íƒ ë° ì‹¤í–‰ ëª¨ë“œ -->
  <macro name="SetupExecutionMode">
    <action name="CreatePopup">
      <Title>ì‹¤í–‰ ì„¤ì •</Title>
      <Message>DB ì €ì¥ ë°©ì‹ ë° ì‹¤í–‰ ì „ëµì„ ì„ íƒí•˜ì„¸ìš”</Message>
    </action>
    <action name="AddChoice"><Option>MongoDB</Option></action>
    <action name="AddChoice"><Option>SQLite</Option></action>
    <action name="AddChoice"><Option>Multilogin</Option></action>
    <action name="AddChoice"><Option>GoLogin</Option></action>
    <action name="ShowPopup"/>
    <action name="GetUserChoice"><Variable>SelectedDB</Variable></action>
    <action name="LogEvent"><Type>UI</Type><Details>ì„ íƒëœ DB/ëª¨ë“œ: {SelectedDB}</Details></action>
  </macro>

  <!-- Fingerprint API í˜¸ì¶œ -->
  <macro name="ApplyFingerprint">
    <action name="HTTPRequest">
      <Method>GET</Method>
      <URL>https://fp.bablosoft.com/api/v1/fingerprint?token=J6tgC3yKrA67k6wr4SpeqWxLlRqgyZ8N0AhkmCmV9jAPC5hxuo1jt9TfFDsWWhJI</URL>
      <ResponseVariable>FP_Response</ResponseVariable>
    </action>
    <action name="ParseJSON">
      <JSON>{FP_Response}</JSON>
      <Key>fingerprint</Key>
      <Variable>FingerprintData</Variable>
    </action>
    <action name="ApplyFingerprint"><Data>{FingerprintData}</Data></action>
  </macro>

  <!-- CIDR í•„í„°ë§ ê·œì¹™ ì ìš© -->
  <macro name="FilterByCIDR">
    <action name="ReadFile"><File>./rules/cidr_rules.txt</File><Variable>CIDRList</Variable></action>
    <action name="CheckIPInCIDR"><IP>{ProxyIP}</IP><CIDRs>{CIDRList}</CIDRs><ResultVariable>IsAllowed</ResultVariable></action>
    <if condition="{IsAllowed} == false">
      <then>
        <action name="LogEvent"><Type>CIDR</Type><Details>í”„ë¡ì‹œ ì œì™¸ë¨ - CIDR ë¶ˆì¼ì¹˜</Details></action>
        <action name="BreakLoop"/>
      </then>
    </if>
  </macro>

  <!-- URL ì§‘ì¤‘/ë¶„ì‚° ì‹œë‚˜ë¦¬ì˜¤ -->
  <macro name="DetermineURLStrategy">
    <parameter name="URL"/>
    <if condition="{URL}.contains('priority')">
      <then>
        <action name="SetVariable"><Variable>WatchDuration</Variable><Value>{Random(3600, 5400)}</Value></action>
        <action name="LogEvent"><Type>Strategy</Type><Details>URL ì§‘ì¤‘ ì‹œì²­ ì ìš©: {URL}</Details></action>
      </then>
      <else>
        <action name="SetVariable"><Variable>WatchDuration</Variable><Value>{Random(600, 1200)}</Value></action>
        <action name="LogEvent"><Type>Strategy</Type><Details>URL ë¶„ì‚° ì‹œì²­ ì ìš©: {URL}</Details></action>
      </else>
    </if>
  </macro>

  <!-- Multilogin / GoLogin í”„ë¡œíŒŒì¼ ì—°ê²° -->
  <macro name="StartBrowserProfile">
    <parameter name="Platform"/>
    <if condition="{Platform} == 'Multilogin'">
      <then>
        <action name="StartMultiloginProfile"><ProfileName>auto_{ThreadIndex}</ProfileName></action>
      </then>
    </if>
    <if condition="{Platform} == 'GoLogin'">
      <then>
        <action name="StartGoLoginProfile"><ProfileID>auto_{ThreadIndex}</ProfileID></action>
      </then>
    </if>
  </macro>

  <!-- ë©”ì¸ ë£¨í”„ ì‹¤í–‰ -->
  <macro name="ExecuteViewers">
    <action name="CallMacro"><Name>SetupExecutionMode</Name></action>
    <action name="ReadFile"><File>./data/target_urls.txt</File><Variable>TargetURLs</Variable></action>
    <loop name="ViewLoop" count="500">
      <action name="SetVariable"><Variable>TargetURL</Variable><Value>{TargetURLs[{ThreadIndex} % TargetURLs.length]}</Value></action>
      <action name="CallMacro"><Name>DetermineURLStrategy</Name><Parameters><URL>{TargetURL}</URL></Parameters></action>
      <action name="CallMacro"><Name>ApplyFingerprint</Name></action>
      <action name="CallMacro"><Name>StartBrowserProfile</Name><Parameters><Platform>{SelectedDB}</Platform></Parameters></action>
      <action name="OpenURL"><URL>{TargetURL}</URL></action>
      <action name="Delay"><Seconds>{WatchDuration}</Seconds></action>
      <action name="CloseBrowser"/>
    </loop>
  </macro>

  <macro name="Main">
    <action name="CallMacro"><Name>ExecuteViewers</Name></action>
  </macro>
</project>
<?xml version="1.0" encoding="UTF-8"?>
<project>
  <settings>
    <MaxThreads>500</MaxThreads>
    <ParallelExecution>true</ParallelExecution>
    <ThreadDelay>50</ThreadDelay>
    <ViewerHealthCheckInterval>60</ViewerHealthCheckInterval>
  </settings>

  <!-- ğŸ“Œ ì‹¤í–‰ ëª¨ë“œ ì„ íƒ UI -->
  <macro name="SetupExecutionOptions">
    <action name="CreatePopup">
      <Title>ì‹¤í–‰ ì˜µì…˜ ì„ íƒ</Title>
      <Message>DB ì €ì¥ ë°©ì‹, ë¸Œë¼ìš°ì € í”„ë¦´ë”© ë° ì „ëµì„ ì„ íƒí•˜ì„¸ìš”</Message>
    </action>
    <action name="AddChoice"><Option>MongoDB</Option></action>
    <action name="AddChoice"><Option>SQLite</Option></action>
    <action name="AddChoice"><Option>Multilogin í”„ë¡œí•„</Option></action>
    <action name="AddChoice"><Option>GoLogin í”„ë¡œí•„</Option></action>
    <action name="ShowPopup"/>
    <action name="GetUserChoice"><Variable>SelectedMode</Variable></action>
    <action name="LogEvent"><Type>Mode</Type><Details>ì„ íƒëœ ëª¨ë“œ: {SelectedMode}</Details></action>
  </macro>

  <!-- ğŸ” Bablosoft / ProxyGeo Fingerprint API í˜¸ì¶œ -->
  <macro name="FetchFingerprint">
    <action name="HTTPRequest">
      <Method>GET</Method>
      <URL>https://fp.bablosoft.com/api/v1/fingerprint?token=J6tgC3yKrA67k6wr4SpeqWxLlRqgyZ8N0AhkmCmV9jAPC5hxuo1jt9TfFDsWWhJI</URL>
      <ResponseVariable>FP1</ResponseVariable>
    </action>
    <action name="HTTPRequest">
      <Method>GET</Method>
      <URL>https://proxygeo.com/api/browser-fingerprint?apikey=ff893e3d-5f3e-43d9-8ac4-b12890fcb72f</URL>
      <ResponseVariable>FP2</ResponseVariable>
    </action>
    <action name="ParseJSON"><JSON>{FP1}</JSON><Key>fingerprint</Key><Variable>Data1</Variable></action>
    <action name="ParseJSON"><JSON>{FP2}</JSON><Key>fingerprint</Key><Variable>Data2</Variable></action>
    <action name="Merge"><Base>{Data1}</Base><Overlay>{Data2}</Overlay><Variable>FinalFingerprint</Variable></action>
    <action name="ApplyFingerprint"><Profile>{FinalFingerprint}</Profile></action>
    <action name="LogEvent"><Type>Fingerprint</Type><Details>Fingerprint ì ìš© ì™„ë£Œ</Details></action>
  </macro>

  <!-- ğŸ§¬ ë¸Œë¼ìš°ì € í”„ë¡œíŒŒì¼ ì´ˆê¸°í™” -->
  <macro name="StartBrowserSession">
    <if condition="{SelectedMode} == 'Multilogin í”„ë¡œí•„'">
      <then><action name="StartMultiloginProfile"><ProfileId>auto_{ThreadIndex}</ProfileId></action></then>
    </if>
    <if condition="{SelectedMode} == 'GoLogin í”„ë¡œí•„'">
      <then><action name="StartGoLoginProfile"><ProfileId>auto_{ThreadIndex}</ProfileId></action></then>
    </if>
  </macro>

  <!-- ğŸ¯ URL ì§‘ì¤‘/ë¶„ì‚° ì „ëµ -->
  <macro name="URLStrategy">
    <parameter name="URL"/>
    <if condition="{URL}.contains('priority')">
      <then>
        <action name="SetVariable"><Variable>WatchDuration</Variable><Value>{Random(3600,5400)}</Value></action>
        <action name="LogEvent"><Type>Strategy</Type><Details>ì§‘ì¤‘ ì‹œì²­: {URL}</Details></action>
      </then>
      <else>
        <action name="SetVariable"><Variable>WatchDuration</Variable><Value>{Random(600,1800)}</Value></action>
        <action name="LogEvent"><Type>Strategy</Type><Details>ë¶„ì‚° ì‹œì²­: {URL}</Details></action>
      </else>
    </if>
  </macro>

  <!-- ğŸ§° CIDR ê¸°ë°˜ í”„ë¡ì‹œ í•„í„°ë§ -->
  <macro name="CIDRFilter">
    <action name="ReadFile"><File>./rules/cidr_rules.txt</File><Variable>CIDRList</Variable></action>
    <action name="ExtractIP"><Proxy>{Account.proxy}</Proxy><Variable>ProxyIP</Variable></action>
    <action name="CheckCIDR"><IP>{ProxyIP}</IP><CIDRs>{CIDRList}</CIDRs><Result>Allowed</Result></action>
    <if condition="{Allowed} == false">
      <then>
        <action name="LogEvent"><Type>CIDR</Type><Details>í•„í„° ì œì™¸ë¨: {ProxyIP}</Details></action>
        <action name="Exit"/>
      </then>
    </if>
  </macro>

  <!-- ğŸ—ƒï¸ DB ì €ì¥ -->
  <macro name="SaveActivity">
    <parameter name="RecordJson"/>
    <if condition="{SelectedMode} == 'MongoDB'">
      <then>
        <action name="MongoInsert">
          <Connection>mongodb://localhost:27017</Connection>
          <Database>bas_logs</Database>
          <Collection>activities</Collection>
          <Document>{RecordJson}</Document>
        </action>
      </then>
    </if>
    <if condition="{SelectedMode} == 'SQLite'">
      <then>
        <action name="SQLiteInsert">
          <File>./data/log.db</File>
          <Table>activity_logs</Table>
          <Data>{RecordJson}</Data>
        </action>
      </then>
    </if>
  </macro>

  <!-- ğŸ”„ ì „ì²´ ì‹œì²­ ë£¨í”„ -->
  <macro name="RunViewSessions">
    <action name="CallMacro"><Name>SetupExecutionOptions</Name></action>
    <action name="ReadFile"><File>./data/target_urls.txt</File><Variable>TargetURLs</Variable></action>

    <loop name="Sessions" count="500">
      <action name="SetVariable"><Variable>TargetURL</Variable><Value>{TargetURLs[{ThreadIndex} % TargetURLs.length]}</Value></action>
      <action name="CallMacro"><Name>URLStrategy</Name><Parameters><URL>{TargetURL}</URL></Parameters></action>
      <action name="CallMacro"><Name>FetchFingerprint</Name></action>
      <action name="CallMacro"><Name>StartBrowserSession</Name></action>
      <action name="OpenURL"><URL>{TargetURL}</URL></action>
      <action name="Delay"><Seconds>{WatchDuration}</Seconds></action>
      <action name="CloseBrowser"/>

      <action name="SetVariable"><Variable>LogRecord</Variable>
        <Value>{"url":"{TargetURL}","duration":"{WatchDuration}","fingerprint_used":"yes","timestamp":"{Timestamp}"}</Value>
      </action>
      <action name="CallMacro"><Name>SaveActivity</Name><Parameters><RecordJson>{LogRecord}</RecordJson></Parameters></action>
    </loop>
  </macro>

  <macro name="Main">
    <action name="CallMacro"><Name>RunViewSessions</Name></action>
  </macro>
</project>
<root>
  <!-- í”„ë¡œí•„ ê²½ë¡œ ë° ì„¤ì • -->
  <action name="SetVar" variable="profile_folder" value="profiles/profile1" />
  <action name="SetVar" variable="cookie_file" value="%profile_folder%/cookies.txt" />
  <action name="SetVar" variable="ua_file" value="%profile_folder%/useragent.txt" />
  <action name="SetVar" variable="proxy_file" value="%profile_folder%/proxy.txt" />

  <!-- í”„ë¡œí•„ í´ë” ì—†ìœ¼ë©´ ìƒì„± -->
  <action name="CreateDir" if="!FileExists('%profile_folder%')">
    <param name="Path">%profile_folder%</param>
  </action>

  <!-- UserAgent ìë™ ìƒì„± ë˜ëŠ” ë¡œë“œ -->
  <action name="If" condition="!FileExists('%ua_file%')">
    <then>
      <action name="RandomUserAgent" variable="ua" />
      <action name="WriteFile">
        <param name="Path">%ua_file%</param>
        <param name="Content">%ua%</param>
      </action>
    </then>
    <else>
      <action name="ReadFile">
        <param name="Path">%ua_file%</param>
        <param name="Variable">ua</param>
      </action>
    </else>
  </action>
  <action name="SetUserAgent">
    <param name="UserAgent">%ua%</param>
  </action>

  <!-- Proxy ìë™ ë¡œë“œ (ì—†ìœ¼ë©´ ë¬´ì‹œ) -->
  <action name="If" condition="FileExists('%proxy_file%')">
    <then>
      <action name="ReadFile">
        <param name="Path">%proxy_file%</param>
        <param name="Variable">proxy</param>
      </action>
      <action name="ParseLine" input="%proxy%" output="proxy_parts" delimiter=":" />
      <action name="SetProxy">
        <param name="Type">HTTP</param>
        <param name="Host">%proxy_parts[0]%</param>
        <param name="Port">%proxy_parts[1]%</param>
      </action>
    </then>
  </action>

  <!-- ì¿ í‚¤ ë¡œë”© -->
  <action name="If" condition="FileExists('%cookie_file%')">
    <then>
      <action name="LoadCookies">
        <param name="Path">%cookie_file%</param>
      </action>
    </then>
  </action>

  <!-- ë¸Œë¼ìš°ì € ì—´ê¸° ë° ì‘ì—… í˜ì´ì§€ ì´ë™ -->
  <action name="Navigate">
    <param name="URL">https://example.com</param>
  </action>

  <!-- ì—¬ê¸°ì— ì‹¤ì „ ìë™í™” ì‘ì—… ì‚½ì… -->
  <!-- ì˜ˆ: ë¡œê·¸ì¸, í´ë¦­, ë°ì´í„° ì¶”ì¶œ ë“± -->

  <!-- ì¿ í‚¤ ì €ì¥ -->
  <action name="SaveCookies">
    <param name="Path">%cookie_file%</param>
  </action>

</root>
<root>

  <!-- [1] CSV ê²½ë¡œ ì§€ì • -->
  <action name="SetVar" variable="csv_path" value="profiles.csv" />

  <!-- [2] CSV ì½ê¸° -->
  <action name="ReadCSV">
    <param name="Path">%csv_path%</param>
    <param name="Table">profile_table</param>
  </action>

  <!-- [3] GUI í…Œì´ë¸” í‘œì‹œ -->
  <action name="ShowTable">
    <param name="Table">profile_table</param>
    <param name="Message">ì‚¬ìš©í•  ë¸Œë¼ìš°ì € í”„ë¡œíŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”</param>
    <param name="SelectedRow">selected_profile</param>
  </action>

  <!-- [4] ì„ íƒëœ í–‰ì—ì„œ ë³€ìˆ˜ ì¶”ì¶œ -->
  <action name="GetTableCell">
    <param name="Table">profile_table</param>
    <param name="Row">%selected_profile%</param>
    <param name="Column">folder</param>
    <param name="Result">profile_folder</param>
  </action>

  <action name="GetTableCell">
    <param name="Table">profile_table</param>
    <param name="Row">%selected_profile%</param>
    <param name="Column">useragent</param>
    <param name="Result">ua</param>
  </action>

  <action name="GetTableCell">
    <param name="Table">profile_table</param>
    <param name="Row">%selected_profile%</param>
    <param name="Column">proxy</param>
    <param name="Result">proxy</param>
  </action>

  <!-- [5] ì¿ í‚¤ ê²½ë¡œ ì„¤ì • -->
  <action name="SetVar" variable="cookie_file" value="profiles/%profile_folder%/cookies.txt" />

  <!-- [6] í”„ë¡œíŒŒì¼ í´ë” ì—†ìœ¼ë©´ ìƒì„± -->
  <action name="CreateDir" if="!FileExists('profiles/%profile_folder%')">
    <param name="Path">profiles/%profile_folder%</param>
  </action>

  <!-- [7] Proxy ìë™ ì ìš© -->
  <action name="ParseLine" input="%proxy%" output="proxy_parts" delimiter=":" />
  <action name="SetProxy">
    <param name="Type">HTTP</param>
    <param name="Host">%proxy_parts[0]%</param>
    <param name="Port">%proxy_parts[1]%</param>
  </action>

  <!-- [8] UserAgent ì ìš© -->
  <action name="SetUserAgent">
    <param name="UserAgent">%ua%</param>
  </action>

  <!-- [9] ì¿ í‚¤ ë¶ˆëŸ¬ì˜¤ê¸° -->
  <action name="If" condition="FileExists('%cookie_file%')">
    <then>
      <action name="LoadCookies">
        <param name="Path">%cookie_file%</param>
      </action>
    </then>
  </action>

  <!-- [10] í…ŒìŠ¤íŠ¸ ì‚¬ì´íŠ¸ ì—´ê¸° -->
  <action name="Navigate">
    <param name="URL">https://example.com</param>
  </action>

  <!-- [11] ì¿ í‚¤ ì €ì¥ -->
  <action name="SaveCookies">
    <param name="Path">%cookie_file%</param>
  </action>

</root>
<root>

  <!-- [1] CSV ê²½ë¡œ ì§€ì • -->
  <action name="SetVar" variable="csv_path" value="profiles.csv" />

  <!-- [2] CSV ì½ê¸° -->
  <action name="ReadCSV">
    <param name="Path">%csv_path%</param>
    <param name="Table">profile_table</param>
  </action>

  <!-- [3] GUI í…Œì´ë¸” í‘œì‹œ -->
  <action name="ShowTable">
    <param name="Table">profile_table</param>
    <param name="Message">ì‚¬ìš©í•  ë¸Œë¼ìš°ì € í”„ë¡œíŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”</param>
    <param name="SelectedRow">selected_profile</param>
  </action>

  <!-- [4] ì„ íƒëœ í–‰ì—ì„œ ë³€ìˆ˜ ì¶”ì¶œ -->
  <action name="GetTableCell">
    <param name="Table">profile_table</param>
    <param name="Row">%selected_profile%</param>
    <param name="Column">folder</param>
    <param name="Result">profile_folder</param>
  </action>

  <action name="GetTableCell">
    <param name="Table">profile_table</param>
    <param name="Row">%selected_profile%</param>
    <param name="Column">useragent</param>
    <param name="Result">ua</param>
  </action>

  <action name="GetTableCell">
    <param name="Table">profile_table</param>
    <param name="Row">%selected_profile%</param>
    <param name="Column">proxy</param>
    <param name="Result">proxy</param>
  </action>

  <!-- [5] ì¿ í‚¤ ê²½ë¡œ ì„¤ì • -->
  <action name="SetVar" variable="cookie_file" value="profiles/%profile_folder%/cookies.txt" />

  <!-- [6] í”„ë¡œíŒŒì¼ í´ë” ì—†ìœ¼ë©´ ìƒì„± -->
  <action name="CreateDir" if="!FileExists('profiles/%profile_folder%')">
    <param name="Path">profiles/%profile_folder%</param>
  </action>

  <!-- [7] Proxy ìë™ ì ìš© -->
  <action name="ParseLine" input="%proxy%" output="proxy_parts" delimiter=":" />
  <action name="SetProxy">
    <param name="Type">HTTP</param>
    <param name="Host">%proxy_parts[0]%</param>
    <param name="Port">%proxy_parts[1]%</param>
  </action>

  <!-- [8] UserAgent ì ìš© -->
  <action name="SetUserAgent">
    <param name="UserAgent">%ua%</param>
  </action>

  <!-- [9] ì¿ í‚¤ ë¶ˆëŸ¬ì˜¤ê¸° -->
  <action name="If" condition="FileExists('%cookie_file%')">
    <then>
      <action name="LoadCookies">
        <param name="Path">%cookie_file%</param>
      </action>
    </then>
  </action>

  <!-- [10] í…ŒìŠ¤íŠ¸ ì‚¬ì´íŠ¸ ì—´ê¸° -->
  <action name="Navigate">
    <param name="URL">https://example.com</param>
  </action>

  <!-- [11] ì¿ í‚¤ ì €ì¥ -->
  <action name="SaveCookies">
    <param name="Path">%cookie_file%</param>
  </action>

</root>
<action name="SetCurrentDate" format="yyyy-MM-dd" result="today_date" />

<action name="SetTableCell">
  <param name="Table">profile_table</param>
  <param name="Row">%selected_row%</param>
  <param name="Column">last_used</param>
  <param name="Value">%today_date%</param>
</action>
<action name="GetTableCell">
  <param name="Table">profile_table</param>
  <param name="Row">%selected_row%</param>
  <param name="Column">usage_count</param>
  <param name="Result">usage_count</param>
</action>

<action name="Math">
  <param name="Operation">+</param>
  <param name="Value1">%usage_count%</param>
  <param name="Value2">1</param>
  <param name="Result">usage_count</param>
</action>

<action name="If" condition="%usage_count% > 5">
  <then>
    <action name="SetVar" variable="usage_count" value="0" />
  </then>
</action>

<action name="SetTableCell">
  <param name="Table">profile_table</param>
  <param name="Row">%selected_row%</param>
  <param name="Column">usage_count</param>
  <param name="Value">%usage_count%</param>
</action>
<action name="IfElementExists">
  <param name="XPath">//*[@id="logout-button"]</param>
  <param name="Result">is_logged_in</param>
</action>

<action name="If" condition="%is_logged_in% == false">
  <then>
    <action name="DeleteFile">
      <param name="Path">%cookie_file%</param>
    </action>
  </then>
</action>
<!-- ì˜ˆ: profile1 ~ profile10ê¹Œì§€ íƒìƒ‰ -->
<action name="SetVar" variable="i" value="1" />
<action name="While" condition="%i% <= 10">
  <do>
    <action name="SetVar" variable="check_folder" value="profiles/profile%i%" />
    <action name="If" condition="FileExists('%check_folder%') == true">
      <then>
        <action name="SetVar" variable="found" value="false" />

        <!-- ê¸°ì¡´ Tableì— í•´ë‹¹ folderê°€ ìˆëŠ”ì§€ ê²€ì‚¬ -->
        <action name="For" table="profile_table" variable="row">
          <action name="GetTableCell">
            <param name="Table">profile_table</param>
            <param name="Row">%row%</param>
            <param name="Column">folder</param>
            <param name="Result">folder_in_table</param>
          </action>
          <action name="If" condition="%folder_in_table% == profile%i%">
            <then>
              <action name="SetVar" variable="found" value="true" />
            </then>
          </action>
        </action>

        <!-- ì—†ìœ¼ë©´ ì‹ ê·œ ë“±ë¡ -->
        <action name="If" condition="%found% == false">
          <then>
            <action name="AddTableRow">
              <param name="Table">profile_table</param>
              <param name="Row">
                profile%i%,profile%i%,Mozilla/5.0...,127.0.0.1:8080,%today_date%,0
              </param>
            </action>
          </then>
        </action>
      </then>
    </action>

    <action name="Math">
      <param name="Operation">+</param>
      <param name="Value1">%i%</param>
      <param name="Value2">1</param>
      <param name="Result">i</param>
    </action>
  </do>
</action>
<action name="WriteTableToCSV">
  <param name="Table">profile_table</param>
  <param name="Path">%csv_path%</param>
</action>
<root>

  <!-- CSV íŒŒì¼ ê²½ë¡œ ì„¤ì • -->
  <action name="SetVar" variable="csv_path" value="profiles.csv" />

  <!-- í˜„ì¬ ë‚ ì§œ ì €ì¥ -->
  <action name="SetCurrentDate" format="yyyy-MM-dd" result="today_date" />

  <!-- CSV ì½ê¸° -->
  <action name="ReadCSV">
    <param name="Path">%csv_path%</param>
    <param name="Table">profile_table</param>
  </action>

  <!-- í”„ë¡œí•„ í´ë” ëª©ë¡ ì½ê¸° -->
  <action name="GetFiles">
    <param name="Directory">profiles</param>
    <param name="Pattern">*</param>
    <param name="OnlyDirectories">true</param>
    <param name="Recursive">false</param>
    <param name="Result">folder_list</param>
  </action>

  <!-- ì‹ ê·œ í´ë” íƒìƒ‰ ë° CSV ìë™ ë“±ë¡ -->
  <action name="ForEach" variable="folder_name" in="folder_list">
    <!-- í´ë”ëª…ì—ì„œ ê²½ë¡œ ì œê±° -->
    <action name="ParsePath">
      <param name="Path">%folder_name%</param>
      <param name="Result">folder_only</param>
      <param name="ParseType">filename</param>
    </action>

    <!-- í˜„ì¬ í´ë”ê°€ CSVì— ìˆëŠ”ì§€ í™•ì¸ -->
    <action name="SetVar" variable="found" value="false" />
    <action name="For" table="profile_table" variable="row">
      <action name="GetTableCell">
        <param name="Table">profile_table</param>
        <param name="Row">%row%</param>
        <param name="Column">folder</param>
        <param name="Result">existing_folder</param>
      </action>
      <action name="If" condition="%existing_folder% == %folder_only%">
        <then>
          <action name="SetVar" variable="found" value="true" />
        </then>
      </action>
    </action>

    <!-- CSVì— ì—†ìœ¼ë©´ ì‹ ê·œ ë“±ë¡ -->
    <action name="If" condition="%found% == false">
      <then>
        <!-- ëœë¤ UserAgent ìƒì„± -->
        <action name="RandomUserAgent" variable="new_ua" />

        <!-- ID ìƒì„±: í˜„ì¬ row ìˆ˜ + 1 -->
        <action name="GetTableSize">
          <param name="Table">profile_table</param>
          <param name="Result">row_count</param>
        </action>

        <action name="Math">
          <param name="Operation">+</param>
          <param name="Value1">%row_count%</param>
          <param name="Value2">1</param>
          <param name="Result">new_id</param>
        </action>

        <!-- CSV í–‰ ì¶”ê°€ -->
        <action name="AddTableRow">
          <param name="Table">profile_table</param>
          <param name="Row">
            %new_id%,%folder_only%,%new_ua%,, %today_date%,0
          </param>
        </action>
      </then>
    </action>

  </action>

  <!-- CSV ì €ì¥ -->
  <action name="WriteTableToCSV">
    <param name="Table">profile_table</param>
    <param name="Path">%csv_path%</param>
  </action>

</root>
<root>
  <!-- í”„ë¡œí•„ ê²½ë¡œ ë° ì„¤ì • -->
  <action name="SetVar" variable="profile_folder" value="profiles/profile1" />
  <action name="SetVar" variable="cookie_file" value="%profile_folder%/cookies.txt" />
  <action name="SetVar" variable="ua_file" value="%profile_folder%/useragent.txt" />
  <action name="SetVar" variable="proxy_file" value="%profile_folder%/proxy.txt" />

  <!-- í”„ë¡œí•„ í´ë” ì—†ìœ¼ë©´ ìƒì„± -->
  <action name="CreateDir" if="!FileExists('%profile_folder%')">
    <param name="Path">%profile_folder%</param>
  </action>

  <!-- UserAgent ìë™ ìƒì„± ë˜ëŠ” ë¡œë“œ -->
  <action name="If" condition="!FileExists('%ua_file%')">
    <then>
      <action name="RandomUserAgent" variable="ua" />
      <action name="WriteFile">
        <param name="Path">%ua_file%</param>
        <param name="Content">%ua%</param>
      </action>
    </then>
    <else>
      <action name="ReadFile">
        <param name="Path">%ua_file%</param>
        <param name="Variable">ua</param>
      </action>
    </else>
  </action>
  <action name="SetUserAgent">
    <param name="UserAgent">%ua%</param>
  </action>

  <!-- Proxy ìë™ ë¡œë“œ (ì—†ìœ¼ë©´ ë¬´ì‹œ) -->
  <action name="If" condition="FileExists('%proxy_file%')">
    <then>
      <action name="ReadFile">
        <param name="Path">%proxy_file%</param>
        <param name="Variable">proxy</param>
      </action>
      <action name="ParseLine" input="%proxy%" output="proxy_parts" delimiter=":" />
      <action name="SetProxy">
        <param name="Type">HTTP</param>
        <param name="Host">%proxy_parts[0]%</param>
        <param name="Port">%proxy_parts[1]%</param>
      </action>
    </then>
  </action>

  <!-- ì¿ í‚¤ ë¡œë”© -->
  <action name="If" condition="FileExists('%cookie_file%')">
    <then>
      <action name="LoadCookies">
        <param name="Path">%cookie_file%</param>
      </action>
    </then>
  </action>

  <!-- ë¸Œë¼ìš°ì € ì—´ê¸° ë° ì‘ì—… í˜ì´ì§€ ì´ë™ -->
  <action name="Navigate">
    <param name="URL">https://example.com</param>
  </action>

  <!-- ì—¬ê¸°ì— ì‹¤ì „ ìë™í™” ì‘ì—… ì‚½ì… -->
  <!-- ì˜ˆ: ë¡œê·¸ì¸, í´ë¦­, ë°ì´í„° ì¶”ì¶œ ë“± -->

  <!-- ì¿ í‚¤ ì €ì¥ -->
  <action name="SaveCookies">
    <param name="Path">%cookie_file%</param>
  </action>

</root>
